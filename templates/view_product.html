{% extends "base.html" %}
{% block title %}ìƒí’ˆ ìƒì„¸ë³´ê¸°{% endblock %}
{% block content %}
<div class="detail-card">
  <h2>{{ product.title }}</h2>

  {% if product.image %}
    <img src="{{ url_for('uploaded_file', filename=product.image) }}" alt="ìƒí’ˆ ì´ë¯¸ì§€" style="max-width: 300px; border-radius: 12px; margin-bottom: 24px;">
  {% else %}
    <p>ğŸ“· ì´ë¯¸ì§€ê°€ ì—†ìŠµë‹ˆë‹¤.</p>
  {% endif %}

  <p>{{ product.description }}</p>
  <p>ê°€ê²©: ğŸ’° {{ product.price }}</p>
  <p>íŒë§¤ì: {{ seller['username'] if seller else 'ì•Œ ìˆ˜ ì—†ìŒ' }}</p>

  {% if user and user['id'] != product['seller_id'] %}
  <div class="button-row">
    <a href="{{ url_for('private_chat', target_id=product['seller_id']) }}" class="btn btn-info">1:1 ì±„íŒ…</a>
    <form action="{{ url_for('pay_to_seller', product_id=product['id']) }}" method="POST" style="display: inline;">
      <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
      <button type="submit" class="btn btn-warning" onclick="return confirm('{{ product.price }}ì›ì„ ì§€ë¶ˆí•˜ì‹œê² ìŠµë‹ˆê¹Œ?');">êµ¬ë§¤í•˜ê¸°</button>
    </form>
  </div>

  {% if seller %}
  <form action="{{ url_for('report') }}" method="POST" style="margin-top: 16px;">
    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
    <input type="hidden" name="target_username" value="{{ seller['username'] }}">
    <label for="reason">ì‹ ê³  ì‚¬ìœ :</label>
    <input type="text" name="reason" required style="margin-left: 8px; padding: 6px; border-radius: 6px; border: 1px solid #ccc;">
    <button type="submit" class="btn btn-danger" style="margin-left: 8px;">ì‹ ê³ í•˜ê¸°</button>
  </form>
  {% endif %}
  {% endif %}

  {% if user and product['seller_id'] == user['id'] %}
  <div class="button-row">
    <a href="{{ url_for('edit_product', product_id=product['id']) }}" class="btn btn-primary">ìˆ˜ì •</a>
    <form action="{{ url_for('delete_product', product_id=product['id']) }}" method="POST" style="display: inline;">
      <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
      <button type="submit" class="btn btn-danger" onclick="return confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?');">ì‚­ì œ</button>
    </form>
  </div>
  {% endif %}
</div>
{% endblock %}
