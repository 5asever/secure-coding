{% extends "base.html" %}
{% block title %}ëŒ€ì‹œë³´ë“œ{% endblock %}
{% block content %}
<h2>ğŸ¥’ ëŒ€ì‹œë³´ë“œ</h2>

<!-- âœ… ê²€ìƒ‰ì°½ê³¼ ë²„íŠ¼ì„ ë”± ë§ì¶° í•œ ì¤„ë¡œ -->
<form method="get" action="{{ url_for('dashboard') }}" 
      style="display: inline-flex; align-items: center; gap: 8px; margin-bottom: 20px;">
  <input type="text" name="q" placeholder="ìƒí’ˆëª… ê²€ìƒ‰" value="{{ keyword }}"
         style="width: 220px; padding: 8px; border: 1px solid #ccc; border-radius: 6px;">
  <button type="submit"
          style="padding: 8px 16px; background-color: #60a862; color: #fff; border: none; border-radius: 6px; font-weight: bold;">
    ê²€ìƒ‰
  </button>
</form>

<h3>ğŸ“¦ ë“±ë¡ëœ ìƒí’ˆ</h3>
{% if products %}
  <ul>
    {% for product in products %}
      <li>
        <a class="product-link" href="{{ url_for('view_product', product_id=product.id) }}">{{ product.title }}</a>
        - ğŸ’° {{ product.price }}
      </li>
    {% endfor %}
  </ul>
{% else %}
  <p>ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤ ğŸ¥²</p>
{% endif %}

<!-- ìƒˆ ìƒí’ˆ ë“±ë¡ -->
<p>
  <a href="{{ url_for('new_product') }}" class="link-button">â• ìƒˆ ìƒí’ˆ ë“±ë¡</a>
</p>


<h3>ğŸ’¬ ì‹¤ì‹œê°„ ì±„íŒ…</h3>
<div id="chat">
  <ul id="messages"></ul>
  <input id="chat_input" type="text" placeholder="ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”">
  <button onclick="sendMessage()">ì „ì†¡</button>
</div>

<script type="text/javascript">
  var socket = io();
  socket.on('connect', function() {
    console.log("ì±„íŒ… ì„œë²„ì— ì—°ê²°ë¨");
  });
  socket.on('message', function(data) {
    var messages = document.getElementById('messages');
    var item = document.createElement('li');
    item.textContent = data.username + ": " + data.message;
    messages.appendChild(item);
    messages.scrollTop = messages.scrollHeight;
  });
  function sendMessage() {
    var input = document.getElementById('chat_input');
    var message = input.value;
    if (message) {
      socket.emit('send_message', { 'username': "{{ user.username }}", 'message': message });
      input.value = "";
    }
  }
</script>
{% endblock %}
